<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="utf-8">
<title>Draft Tier 0-3 • Salgueiros FC</title>
<style>
*{box-sizing:border-box;font-family:system-ui,arial,helvetica,sans-serif}
body{margin:0;padding:20px;display:flex;gap:20px}
#left{width:40%}
#teams{flex:1;display:flex;gap:20px}
textarea{width:100%;height:60px;margin-bottom:10px;padding:6px;border:1px solid #999;border-radius:4px;resize:vertical}
button{padding:6px 12px;border:0;border-radius:6px;background:#007bff;color:#fff;cursor:pointer;margin-right:6px}
button:hover{background:#0061d1}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:6px;text-align:left}
th{background:#eee}
td.nome{cursor:grab}
tr.picked td{text-decoration:line-through}
tr.unpicked td.nome{color:#d00}
.team{border:1px solid #777;border-radius:6px;padding:8px;flex:1;min-height:300px;display:flex;flex-direction:column;gap:4px}
.slot{border:1px dashed #aaa;border-radius:4px;padding:6px;min-height:24px;cursor:pointer;display:flex;align-items:center;gap:6px}
.slot.filled{border-style:solid;background:#f5f5f5}
.remove{margin-left:auto;background:none;border:none;font-weight:bold;width:18px;height:18px;line-height:16px;font-size:12px;cursor:pointer}
.remove:hover{opacity:.4}
.skeleton{background:#e0e0e0;position:relative;overflow:hidden}
.skeleton::after{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.6),transparent);animation:load 1.2s infinite}
@keyframes load{0%{left:-100%}50%{left:100%}100%{left:100%}}
.branding{display:flex;align-items:center;margin-top:20px;gap:12px}
.branding img{width:120px;height:120px;border-radius:50%;object-fit:cover}
.branding span{font-size:1.25rem;font-weight:700}
</style>
</head>
<body>
<div id="left">
  <textarea id="lista" placeholder="Cole nomes confirmados separados por vírgula"></textarea>
  <div>
    <button id="gerar">Gerar Draft</button>
    <button id="full">Sortear Completo</button>
  </div>
  <h3>Pool Tier 2-3</h3>
  <table>
    <thead><tr><th>Nome</th><th>Tier</th><th>Status</th></tr></thead>
    <tbody id="pool"></tbody>
  </table>
  <div class="branding">
    <img src="https://media-lis1-1.cdn.whatsapp.net/v/t61.24694-24/490582880_673190018857920_7995704823271648352_n.jpg?ccb=11-4&oh=01_Q5Aa2AFUwOMmp_2xN2tuzDaZhXR_OT1Yc-0Rq5skDkHvmSvQfA&oe=689878F2&_nc_sid=5e03e0&_nc_cat=105" alt="Salgueiros FC">
    <span>Salgueiros FC</span>
  </div>
</div>

<div id="teams"></div>

<script>
const base = [
	{ n: "Alê", t: 0 },
	{ n: "Thales Garcia", t: 0 },
	{ n: "Nelson", t: 0 },
	{ n: "Diego Griep", t: 0 },
	{ n: "Will", t: 0 },
	{ n: "Zé", t: 0 },
	{ n: "Lucas Oliveira", t: 1 },
	{ n: "João Oliveira", t: 1 },
	{ n: "Rafael Mizerani", t: 1 },
	{ n: "Luciano Jr.", t: 1 },
	{ n: "Pretzel", t: 1 },
	{ n: "Vicente", t: 1 },
	{ n: "Ricardo", t: 1 },
	{ n: "Rafael Esquiçato", t: 2 },
	{ n: "Guilherme", t: 2 },
	{ n: "Fabio Manzatto", t: 2 },
	{ n: "Thiago Calazans", t: 2 },
	{ n: "Mauricio", t: 2 },
	{ n: "Daniel Coutinho", t: 2 },
	{ n: "Castilho", t: 2 },
	{ n: "Olavo", t: 2 },
	{ n: "Breno", t: 2 },
	{ n: "Deni", t: 2 },
	{ n: "Thiago Charamba", t: 2 },
	{ n: "Thales", t: 2 },
	{ n: "Douglas", t: 2 },
	{ n: "Victor Miranda", t: 2 },
	{ n: "Luis", t: 2 },
	{ n: "Thiago Ferreira", t: 2 },
	{ n: "Vica", t: 2 },
	{ n: "Lucas Araújo", t: 2 },
	{ n: "Mateus Bolsoni", t: 3 },
	{ n: "Thiago Alves", t: 3 },
	{ n: "Laercio", t: 3 },
	{ n: "Brunno Simoes", t: 3 },
	{ n: "Salah", t: 0 },
  { n: "Lucas (amigo do vica)", t: 2 },
];

const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a};
function skeleton(){
  const teamsDiv=document.getElementById("teams");teamsDiv.innerHTML="";
  for(let i=0;i<3;i++){
    const d=document.createElement("div");d.className="team";
    d.innerHTML='<strong class="skeleton" style="height:18px;width:70px;border-radius:4px"></strong>';
    for(let k=0;k<7;k++){
      const s=document.createElement("div");s.className="slot skeleton";s.style.height="20px";d.appendChild(s);
    }
    teamsDiv.appendChild(d);
  }
  const tbody=document.getElementById("pool");tbody.innerHTML="";
  for(let r=0;r<6;r++){
    const tr=document.createElement("tr");
    tr.innerHTML='<td class="skeleton" style="height:18px"></td><td class="skeleton" style="width:40px;height:18px"></td><td class="skeleton" style="width:80px;height:18px"></td>';
    tbody.appendChild(tr);
  }
}
function updatePoolHighlight(){
  const full=[...document.querySelectorAll(".team")].every(t=>t.querySelectorAll(".filled").length===7);
  document.querySelectorAll("#pool tr").forEach(tr=>{
    full&&!tr.classList.contains("picked")?tr.classList.add("unpicked"):tr.classList.remove("unpicked");
  });
}
function render(times,pool){
  const teamsDiv=document.getElementById("teams");teamsDiv.innerHTML="";
  times.forEach((t,i)=>{
    const div=document.createElement("div");div.className="team";
    div.innerHTML=`<strong>Time ${i+1}</strong>`;
    t.forEach(p=>{
      const slot=document.createElement("div");slot.className="slot filled";
      slot.textContent=`${p.n} (T${p.t})`;div.appendChild(slot);
    });
    for(let k=t.length;k<7;k++){
      const slot=document.createElement("div");slot.className="slot";
      slot.ondragover=e=>e.preventDefault();
      slot.ondrop=dropHandler;div.appendChild(slot);
    }
    teamsDiv.appendChild(div);
  });
  const tbody=document.getElementById("pool");tbody.innerHTML="";
  pool.forEach(p=>{
    const tr=document.createElement("tr");tr.id="p_"+p.n.replace(/\s+/g,"_");
    const tdNome=document.createElement("td");tdNome.className="nome";tdNome.textContent=p.n;tdNome.draggable=true;
    tdNome.ondragstart=e=>e.dataTransfer.setData("text/plain",p.n);
    const tdTier=document.createElement("td");tdTier.textContent=p.t;
    const tdStatus=document.createElement("td");tdStatus.className="status";tdStatus.textContent="Disponível";
    tr.appendChild(tdNome);tr.appendChild(tdTier);tr.appendChild(tdStatus);tbody.appendChild(tr);
  });
  updatePoolHighlight();
}
function draftPrioridade(confirmados){
  const confirmSet=confirmados.map(s=>s.toLowerCase());
  const oficiais=base.filter(p=>confirmSet.includes(p.n.toLowerCase()));
  const fantasmas=confirmados.filter(n=>!base.some(b=>b.n.toLowerCase()===n.toLowerCase())).map(n=>({n,t:3}));
  const t0=shuffle(oficiais.filter(p=>p.t===0));
  const t1=shuffle(oficiais.filter(p=>p.t===1));
  const pool=shuffle([...oficiais.filter(p=>p.t>1),...fantasmas]);
  const teams=[[],[],[]];
  let idx=Math.floor(Math.random()*3);
  t0.forEach(p=>{teams[idx].push(p);idx=(idx+1)%3});
  t1.forEach(p=>{teams[idx].push(p);idx=(idx+1)%3});
  return{teams,pool};
}
function draftCompleto(confirmados){
  const confirmSet=confirmados.map(s=>s.toLowerCase());
  const oficiais=base.filter(p=>confirmSet.includes(p.n.toLowerCase()));
  const fantasmas=confirmados.filter(n=>!base.some(b=>b.n.toLowerCase()===n.toLowerCase())).map(n=>({n,t:3}));
  const tier0=shuffle(oficiais.filter(p=>p.t===0));
  const tier1=shuffle(oficiais.filter(p=>p.t===1));
  const tier2=shuffle(oficiais.filter(p=>p.t===2));
  const tier3=shuffle([...oficiais.filter(p=>p.t===3),...fantasmas]);
  const tiers=[tier0,tier1,tier2,tier3];
  const teams=[[],[],[]];
  let idx=0;
  tiers.forEach(lista=>lista.forEach(p=>{teams[idx].push(p);idx=(idx+1)%3}));
  const alocados=new Set(teams.flat().map(p=>p.n));
  const pool=[...tier0,...tier1,...tier2,...tier3].filter(p=>!alocados.has(p.n));
  return{teams,pool};
}
function dropHandler(e){
  e.preventDefault();
  if(this.classList.contains("filled"))return;
  const nome=e.dataTransfer.getData("text/plain");
  const row=document.getElementById("p_"+nome.replace(/\s+/g,"_"));
  if(!row||row.classList.contains("picked"))return;
  this.innerHTML=`<span>${nome}</span><button class="remove">×</button>`;
  this.classList.add("filled");
  row.classList.add("picked");
  row.querySelector(".status").textContent="Escalado";
  updatePoolHighlight();
  this.querySelector(".remove").onclick=()=>{
    this.classList.remove("filled");this.innerHTML="";
    row.classList.remove("picked");
    row.querySelector(".status").textContent="Disponível";
    updatePoolHighlight();
  };
}
document.getElementById("gerar").onclick=()=>{
  skeleton();
  setTimeout(()=>{
    const confirmados=document.getElementById("lista").value.split(",").map(s=>s.trim()).filter(Boolean);
    const{teams,pool}=draftPrioridade(confirmados);
    render(teams,pool);
  },600);
};
document.getElementById("full").onclick=()=>{
  skeleton();
  setTimeout(()=>{
    const confirmados=document.getElementById("lista").value.split(",").map(s=>s.trim()).filter(Boolean);
    const{teams,pool}=draftCompleto(confirmados);
    render(teams,pool);
  },600);
};
</script>
</body>
</html>
